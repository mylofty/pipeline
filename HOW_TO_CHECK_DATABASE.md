# 如何检查数据库是否使用了原始数据

## 🔍 快速检查方法

### 1. 使用数据库内容查看器
访问页面：`/pages/test/database-viewer`

**功能特点**：
- 📊 查看每个表的详细数据
- 📈 显示记录数统计
- 🔍 智能诊断原始数据
- 📋 导出表数据
- 📝 生成诊断报告

### 2. 一键诊断
点击"检查原始数据"按钮，系统会：
- 分析所有表的数据量
- 检测数据特征和内容
- 判断是否使用了原始数据
- 生成详细的诊断报告

## 📋 判断标准

### ✅ 使用了原始数据的特征
- **有实际记录数**：表中有大量真实数据记录
- **业务字段有值**：项目名称、管点编号、坐标等字段有实际值
- **数据多样性**：不同记录有不同的值，不是重复的测试数据
- **时间戳合理**：创建时间不是刚刚初始化的时间
- **无测试标识**：数据中不包含"测试"、"test"等测试标识

### ⚠️ 使用了新建空表的特征
- **记录数为0**：所有表都是空的
- **只有表结构**：表存在但没有数据
- **测试数据**：只有少量包含"测试"字样的数据
- **字段名异常**：出现 `field_0`, `field_1` 等通用字段名

## 🔧 详细检查步骤

### 步骤1：打开数据库查看器
```
导航到：/pages/test/database-viewer
```

### 步骤2：查看数据库状态
查看页面顶部的数据库信息：
- **数据库类型**：native（原生SQLite）或 storage（存储适配器）
- **连接状态**：已连接 或 未连接

### 步骤3：选择表查看数据
1. 使用下拉菜单选择要查看的表
2. 查看记录数统计
3. 浏览实际数据内容

**重点检查的表**：
- `projects` - 项目信息
- `pipe_points` - 管点数据
- `pipe_lines` - 管线数据

### 步骤4：运行智能诊断
点击"检查原始数据"按钮：
1. 系统会分析所有表
2. 检测数据特征
3. 生成诊断结果
4. 提供改进建议

## 📊 诊断结果解读

### 结果类型

#### ✅ "检测到原始数据"
```
✅ 检测到原始数据
成功检测到原始数据！

统计信息：
- 总记录数：1,234 条
- 有数据的表：6/8 个
- 数据库类型：native

这表明你的 base.db 文件已成功加载。
```

#### ⚠️ "未检测到数据"
```
⚠️ 未检测到数据
所有表都是空的，当前使用的是新创建的空表，
而不是你原始的 base.db 数据。

建议检查数据库文件是否正确放置在 
static/database/base.db 位置。
```

#### ⚠️ "数据来源不确定"
```
⚠️ 数据来源不确定
检测到 50 条记录，但可能不是原始数据。

这些数据可能来自：
- 测试数据
- 初始化过程
- 部分原始数据

建议查看具体表内容进行确认。
```

## 🛠️ 问题排查

### 问题1：所有表都是空的
**可能原因**：
- 数据库文件没有正确放置
- 文件复制失败
- 使用了Storage适配器但没有导入数据

**解决方案**：
1. 确认 `static/database/base.db` 文件存在
2. 检查文件大小不为0
3. 重启应用重新初始化
4. 查看控制台日志

### 问题2：只有测试数据
**可能原因**：
- 系统创建了测试数据
- 原始数据没有成功加载

**解决方案**：
1. 清除应用数据
2. 重新放置数据库文件
3. 重新安装应用

### 问题3：数据库类型是storage
**说明**：
- 当前使用Storage适配器
- 在Android设备上应该使用native类型
- Storage适配器性能较低但兼容性好

**改进方案**：
1. 在Android设备上测试
2. 检查原生SQLite插件配置
3. 确认数据库文件路径

## 📱 实际操作示例

### 检查projects表
1. 选择"projects"表
2. 查看记录数（应该 > 0）
3. 查看数据内容：
   - `project_name`：应该有实际的项目名称
   - `work_group`：应该有工作组信息
   - `created_time`：应该有合理的创建时间

### 检查pipe_points表
1. 选择"pipe_points"表
2. 查看记录数（应该是最多的）
3. 查看数据内容：
   - `point_number`：应该有管点编号
   - `longitude`, `latitude`：应该有实际坐标
   - `pipe_type`：应该有管线类型

## 🎯 最终确认

如果看到以下情况，说明成功使用了原始数据：
- ✅ 多个表有大量数据记录
- ✅ 数据内容是实际的业务数据
- ✅ 没有"测试"、"field_"等标识
- ✅ 诊断结果显示"检测到原始数据"

如果所有表都是空的或只有测试数据，说明需要重新配置数据库文件。